webpackJsonp([25],{y2qu:function(t,e){},zhBu:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("Xxa5"),a=n.n(i),r=n("exGp"),s=n.n(r),o=n("g7mi"),c={name:"ribbonInfo",data:function(){return{isDisabled:!1,sheetVisible:!1,adminname:"",roleId:0,text:"",actions:[],info:{},furnace:this.$route.query.f,coilNumber:this.$route.query.c,disabled:!1}},computed:{status:function(){var t="重卷完",e=this.info,n=e.isRollConfirmed,i=e.isMeasureConfirmed,a=e.isStorageConfirmed;e.isStored;return 1===n&&(t="已送检"),1===i&&(t="申请入库"),1===a&&(t="已入库"),t},storeType:function(){var t="",e=this.info.isStored;return 1===e&&(t="计划内入库"),2===e&&(t="计划外入库"),t}},watch:{$route:{handler:function(){this.furnace=this.$route.query.f,this.coilNumber=this.$route.query.c,this.$message({message:"我刷新了",type:"success"}),this.getData()},deep:!0,immediate:!0}},created:function(){var t=this;return s()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getUserInfo();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:n=e.t0,t.adminname=n.adminname,t.roleId=n.roleId,t.actions=[{name:"当前登录："+t.adminname},{name:"退出登录",method:t.signout}];case 9:case"end":return e.stop()}},e,t)}))()},methods:{getUserInfo:function(){var t=this;return s()(a.a.mark(function e(){var n,i,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=window&&window.localStorage?"local":"ajax",i={local:function(){return JSON.parse(window.localStorage.getItem("userinfo"))||{}},ajax:function(){return t.$http("get",o.a.getUserInfo,{}).then(function(t){return t}).catch(function(t){return console.log(t)})}}[n],e.next=4,i();case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:return r=e.t0,e.abrupt("return",r);case 9:case"end":return e.stop()}},e,t)}))()},handleMore:function(){this.sheetVisible=!0},signout:function(){var t=this;this.isDisabled=!0,this.$http("POST",o.a.signout,{}).then(function(e){try{window.localStorage.removeItem("userinfo")}catch(e){t.$message({message:e.message||"localStorage 错误",type:"error"})}var n=encodeURIComponent(window.location.href);t.$router.push({path:"/login",query:{returnUrl:n}})}).catch(function(t){console.log(t)}).finally(function(){t.isDisabled=!1})},getData:function(){var t=this,e=this.furnace,n=parseInt(this.coilNumber);this.$http("GET",o.a.queryRibbonInfo,{furnace:e,coilNumber:n}).then(function(e){var n=e.list&&e.list[0]||{};t.info=n}).catch(function(e){t.$message({message:error.message||"数据请求错误",type:"error"})})},scanConfirm:function(){var t=this,e={furnace:this.furnace,coilNumber:this.coilNumber};this.$http("POST",o.a.scanConfirm,e).then(function(e){e.status?t.disabled=!1:t.disabled=!0}).catch(function(e){t.$message({message:error.message||"下一盘确认失败",type:"error"}),t.disabled=!1})},addStorage:function(){var t=this;this.$http("POST",o.a.addStorage,{data:this.info}).then(function(e){e.status?t.disabled=!1:t.disabled=!0}).catch(function(e){t.$message({message:error.message||"确认入库失败",type:"error"}),t.disabled=!1})},handleFinish:function(){this.$router.push({path:"/scanList"})}}},l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("mt-header",{attrs:{fixed:"",title:"带材信息"}},[n("mt-button",{attrs:{slot:"right",icon:"more"},on:{click:t.handleMore},slot:"right"})],1),t._v(" "),n("div",{staticClass:"content"},[n("mt-cell",{attrs:{title:"炉号",value:t.info.furnace}}),t._v(" "),n("mt-cell",{attrs:{title:"盘号",value:t.info.coilNumber}}),t._v(" "),n("mt-cell",{attrs:{title:"材质",value:t.info.ribbonTypeName}}),t._v(" "),n("mt-cell",{attrs:{title:"规格",value:t.info.ribbonWidth+" mm"}}),t._v(" "),n("mt-cell",{attrs:{title:"重量",value:t.info.coilWeight+" kg"}}),t._v(" "),n("mt-cell",{attrs:{title:"级别",value:t.info.ribbonTotalLevel}}),t._v(" "),n("mt-cell",{attrs:{title:"状态",value:t.status}}),t._v(" "),1===t.info.isStorageConfirmed?n("mt-cell",{attrs:{title:"入库类型",value:t.storeType}}):t._e(),t._v(" "),6===t.roleId?n("p",{staticClass:"text_danger tip"},[t._v("\n      备注： 1. 在操作入库的流程时，要入库，则点击【确认入库】； 2.\n      在操作入仓位的流程时，要继续扫下一盘，则点击【下一盘】；\n    ")]):t._e()],1),t._v(" "),6===t.roleId?n("div",{staticClass:"btn-wrapp"},[1===t.info.isMeasureConfirmed&&0===t.info.isStorageConfirmed&&1===t.info.isRollConfirmed?n("mt-button",{attrs:{type:"primary",disabled:t.disabled},on:{click:t.addStorage}},[t._v("确认入库")]):t._e(),t._v(" "),1!==t.info.isStorageConfirmed||t.info.place?t._e():n("mt-button",{attrs:{type:"primary",disabled:t.disabled},on:{click:t.scanConfirm}},[t._v("下一盘")])],1):t._e(),t._v(" "),n("mt-actionsheet",{attrs:{actions:t.actions},model:{value:t.sheetVisible,callback:function(e){t.sheetVisible=e},expression:"sheetVisible"}})],1)},staticRenderFns:[]};var u=n("VU/8")(c,l,!1,function(t){n("y2qu")},"data-v-517be714",null);e.default=u.exports}});
//# sourceMappingURL=ribbonInfo.1151c0ee6a9985d05338.js.map