webpackJsonp([29],{vm2q:function(e,t){},zhBu:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("Xxa5"),a=n.n(i),r=n("exGp"),o=n.n(r),s=n("g7mi"),c=n("Au9i"),l={name:"ribbonInfo",data:function(){return{isDisabled:!1,sheetVisible:!1,adminname:"",roleId:0,text:"",actions:[],info:{},furnace:this.$route.query.f,coilNumber:this.$route.query.c,addDisabled:!1,scanDisabled:!1,rejectDisabled:!1}},computed:{status:function(){var e="重卷完",t=this.info,n=t.isRollConfirmed,i=t.isMeasureConfirmed,a=t.isStorageConfirmed;t.isStored;return 1===n&&(e="已送检"),1===i&&(e="申请入库"),1===a&&(e="已入库"),e},storeType:function(){var e="",t=this.info.isStored;return 1===t&&(e="计划内入库"),2===t&&(e="计划外入库"),e}},watch:{$route:{handler:function(){this.furnace=this.$route.query.f,this.coilNumber=this.$route.query.c,this.$message({message:"我刷新了",type:"success"}),this.getData()},deep:!0,immediate:!0}},created:function(){var e=this;return o()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getUserInfo();case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:n=t.t0,e.adminname=n.adminname,e.roleId=n.roleId,e.actions=[{name:"当前登录："+e.adminname},{name:"退出登录",method:e.signout}];case 9:case"end":return t.stop()}},t,e)}))()},methods:{getUserInfo:function(){var e=this;return o()(a.a.mark(function t(){var n,i,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=window&&window.localStorage?"local":"ajax",i={local:function(){return JSON.parse(window.localStorage.getItem("userinfo"))||{}},ajax:function(){return e.$http("get",s.a.getUserInfo,{}).then(function(e){return e}).catch(function(e){return console.log(e)})}}[n],t.next=4,i();case 4:if(t.t0=t.sent,t.t0){t.next=7;break}t.t0={};case 7:return r=t.t0,t.abrupt("return",r);case 9:case"end":return t.stop()}},t,e)}))()},handleMore:function(){this.sheetVisible=!0},signout:function(){var e=this;this.isDisabled=!0,this.$http("POST",s.a.signout,{}).then(function(t){try{window.localStorage.removeItem("userinfo")}catch(t){e.$message({message:t.message||"localStorage 错误",type:"error"})}var n=encodeURIComponent(window.location.href);e.$router.push({path:"/login",query:{returnUrl:n}})}).catch(function(e){console.log(e)}).finally(function(){e.isDisabled=!1})},getData:function(){var e=this,t=this.furnace,n=parseInt(this.coilNumber);this.$http("GET",s.a.queryRibbonInfo,{furnace:t,coilNumber:n}).then(function(t){var n=t.list&&t.list[0]||{};e.info=n}).catch(function(t){e.$message({message:error.message||"数据请求错误",type:"error"})})},scanConfirm:function(){var e=this,t={furnace:this.furnace,coilNumber:this.coilNumber};this.scanDisabled=!0,this.$http("POST",s.a.scanConfirm,t).then(function(e){window.location.reload()}).catch(function(t){e.$message({message:error.message||"下一盘确认失败",type:"error"})}).finally(function(){return e.scanDisabled=!1})},addStorage:function(){var e=this;this.$message({message:"点击了",type:"success"}),this.addDisabled=!0,this.$http("POST",s.a.addStorage,{data:this.info}).then(function(e){window.location.reload()}).catch(function(t){e.$message({message:error.message||"确认入库失败",type:"error"})}).finally(function(){return e.addDisabled=!1})},rejectApplyStorage:function(){var e=this,t=this.info,n=t.measureId;t.furnace,t.coilNumber;c.MessageBox.prompt("请输入驳回原因").then(function(t){var i=t.value,a=t.action;console.log("输入的值",i),console.log("action",a),e.rejectDisabled=!0,e.$http("post",s.a.rejectApplyStorage,{measureId:n,rejectReason:i}).then(function(e){window.location.reload()}).catch(function(e){console.log(e)}).finally(function(){return e.rejectDisabled=!1})}).catch(function(){})},handleFinish:function(){this.$router.push({path:"/scanList"})}}},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("mt-header",{attrs:{fixed:"",title:"带材信息"}},[n("mt-button",{attrs:{slot:"right",icon:"more"},on:{click:e.handleMore},slot:"right"})],1),e._v(" "),n("div",{staticClass:"content"},[n("mt-cell",{attrs:{title:"炉号",value:e.info.furnace}}),e._v(" "),n("mt-cell",{attrs:{title:"盘号",value:e.info.coilNumber}}),e._v(" "),n("mt-cell",{attrs:{title:"材质",value:e.info.ribbonTypeName}}),e._v(" "),n("mt-cell",{attrs:{title:"规格",value:e.info.ribbonWidth+" mm"}}),e._v(" "),n("mt-cell",{attrs:{title:"重量",value:e.info.coilWeight+" kg"}}),e._v(" "),n("mt-cell",{attrs:{title:"级别",value:e.info.ribbonTotalLevel}}),e._v(" "),n("mt-cell",{attrs:{title:"状态",value:e.status}}),e._v(" "),1===e.info.isStorageConfirmed?n("mt-cell",{attrs:{title:"入库类型",value:e.storeType}}):e._e(),e._v(" "),6===e.roleId?n("p",{staticClass:"text_danger tip"},[e._v("\n      备注： 1. 在操作入库的流程时，要入库，则点击【确认入库】； 2.\n      在操作入仓位的流程时，要继续扫下一盘，则点击【下一盘】；\n    ")]):e._e()],1),e._v(" "),6===e.roleId?n("div",{staticClass:"btn-wrapp"},[1===e.info.isMeasureConfirmed&&0===e.info.isStorageConfirmed&&1===e.info.isRollConfirmed?n("mt-button",{attrs:{type:"primary",disabled:e.addDisabled},on:{click:e.addStorage}},[e._v("确认入库")]):e._e(),e._v(" "),1===e.info.isMeasureConfirmed&&0===e.info.isStorageConfirmed&&1===e.info.isRollConfirmed?n("mt-button",{attrs:{type:"primary",disabled:e.rejectDisabled},on:{click:e.rejectApplyStorage}},[e._v("驳回")]):e._e(),e._v(" "),1!==e.info.isStorageConfirmed||e.info.place?e._e():n("mt-button",{attrs:{type:"primary",disabled:e.scanDisabled},on:{click:e.scanConfirm}},[e._v("下一盘")])],1):e._e(),e._v(" "),n("mt-actionsheet",{attrs:{actions:e.actions},model:{value:e.sheetVisible,callback:function(t){e.sheetVisible=t},expression:"sheetVisible"}})],1)},staticRenderFns:[]};var f=n("VU/8")(l,u,!1,function(e){n("vm2q")},"data-v-1f38650d",null);t.default=f.exports}});
//# sourceMappingURL=ribbonInfo.03926290a16abd6c9aa3.js.map