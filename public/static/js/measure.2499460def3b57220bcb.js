webpackJsonp([1],{"5qv0":function(e,n){},"6xz9":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("BO1k"),r=t.n(i),o=t("fZjL"),s=t.n(o),a=t("woOf"),l=t.n(a),c=t("mvHQ"),b=t.n(c),u=t("2X9z"),h=t.n(u),p=t("Xxa5"),d=t.n(p),v=t("exGp"),f=t.n(v),m=t("Dd8w"),g=t.n(m),T=t("mw3O"),k=t.n(T),_=t("M4fF"),L=t("g7mi"),w=t("X2Oc"),y=t("NYxO"),x={name:"melt",components:{Collapse:t("IC2r").a},data:function(){return{userinfo:{},castId:6,searchForm:{caster:"",furnace:"",date:[],ribbonTypeNames:[],ribbonWidths:[],ribbonThicknessLevels:[],laminationLevels:[],ribbonToughnessLevels:[],appearenceLevels:[],thicknessDivation:""},loading:!1,tableData:[],pageConfig:{total:1,current:1,pageSize:10},isExportable:!1,isEditable:!1,isDeleteable:!1,tableHeight:550,multipleSelection:[],isBatchInStored:!1,isAutoQuerying:!1,pollTimer:null}},computed:g()({autoQueryConfig:function(){return{icon:this.isAutoQuerying?"el-icon-video-pause":"el-icon-video-play",text:this.isAutoQuerying?"停止自动更新":"启动自动更新",type:this.isAutoQuerying?"danger":"primary"}}},Object(y.c)(["ribbonToughnessLevelList","ribbonTypeList","ribbonWidthList","ribbonThicknessLevelList","laminationLevelList","clientsList","appearenceList","linerWeightList"]),{uniqueAppearenceLevelList:function(){return this.appearenceList.reduce(function(e,n){return e.includes(n.appearenceLevel)||e.push(n.appearenceLevel),e},[])}}),beforeRouteUpdate:function(e,n,t){this.castId=e.params.castId,this.getTableData(),this.isExportable=this.setExportable(),this.isEditable=this.setEditable(),this.isDeleteable=this.setDeleteable(),this.isBatchInStored=this.setBatchInStored(),t()},created:function(){var e=this;return f()(d.a.mark(function n(){return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.castId=e.$route.params.castId,e.userinfo=JSON.parse(localStorage.getItem("userinfo")),e.isExportable=e.setExportable(),e.isEditable=e.setEditable(),e.isDeleteable=e.setDeleteable(),e.isBatchInStored=e.setBatchInStored(),n.next=8,e.getLinerWeightList();case 8:return n.next=10,e.getRibbonToughnessLevelList();case 10:return n.next=12,e.getRibbonTypeList();case 12:return n.next=14,e.getRibbonWidthList();case 14:return n.next=16,e.getRibbonThicknessLevelList();case 16:return n.next=18,e.getLaminationLevelList();case 18:return n.next=20,e.getClientsList();case 20:return n.next=22,e.getAppearenceLevelList();case 22:e.getTableData();case 23:case"end":return n.stop()}},n,e)}))()},mounted:function(){var e=this;e.$nextTick(function(){e.tableHeight=window.innerHeight-80}),window.onresize=Object(w.c)(function(){e.tableHeight=window.innerHeight-80},1e3)},beforeDestroy:function(){clearInterval(this.pollTimer),this.pollTimer=null},methods:g()({handleAutoQuery:function(){var e=this,n=this.isAutoQuerying;this.isAutoQuerying=!n,this.isAutoQuerying?(clearInterval(this.pollTimer),this.getTableData(),this.pollTimer=setInterval(function(){e.getTableData()},5e3)):this.pollTimer&&clearInterval(this.pollTimer)},batchCalcRibbonTotalData:function(){var e=this,n=this.tableData.filter(function(e){return!e.ribbonTotalLevel&&[e.ribbonThickness1,e.ribbonThickness2,e.ribbonThickness3,e.ribbonThickness4,e.ribbonThickness5,e.ribbonThickness6,e.ribbonThickness7,e.ribbonThickness8,e.ribbonThickness9,e.realRibbonWidth,e.ribbonToughnessLevel,e.appearenceLevel].every(function(e){return!!e})});if(!Array.isArray(n)||0===n.length)return h()({message:"没有找到需要计算综合级别的带材，请确认 带材厚度/带宽/韧性等级/外观等级 等数据是否完整",type:"error"});n=n.map(function(n){var t=e.calcRibbonTotalData(n);return g()({},n,t)}),this.$http("PUT",L.a.updateMeasureByBatch,{listJson:b()(n)}).then(function(n){e.getTableData({current:e.pageConfig.current||1})}).catch(function(e){return console.log(e)})},thicknessChangeHandler:function(e,n){var t=[n.ribbonThickness1,n.ribbonThickness2,n.ribbonThickness3,n.ribbonThickness4,n.ribbonThickness5,n.ribbonThickness6,n.ribbonThickness7,n.ribbonThickness8,n.ribbonThickness9];t=t.map(function(e){if(""!==e)return Number(e)}).filter(function(e){return void 0!==e}),n.ribbonThicknessDeviation=this.calcMaxDeviation(t),n.ribbonThickness=t.length>0?(t.reduce(function(e,n){return e+n},0)/t.length).toFixed(2):0,n.ribbonThicknessLevel=this.calcribbonThicknessLevel(n.ribbonThickness)}},Object(y.b)(["getRibbonToughnessLevelList","getRibbonTypeList","getRibbonWidthList","getRibbonThicknessLevelList","getLaminationLevelList","getClientsList","getAppearenceLevelList","getLinerWeightList"]),{dateFormat:function(e,n){return Object(w.a)(e.castDate)},dateTimeFormat:function(e,n){return e.measureDate?Object(w.b)(e.measureDate):""},setEditable:function(){return 5==this.userinfo.roleId},setDeleteable:function(){return 1==this.userinfo.roleId},setExportable:function(){return!![1,2,3,5].includes(this.userinfo.roleId)},setBatchInStored:function(){return!![1,5].includes(this.userinfo.roleId)},calcLinerWeight:function(e){e=Number(e);var n=(this.linerWeightList.find(function(n){return n.ribbonWidth===e})||{}).linerWeight;return n||(h()({message:"带材宽度"+e+"没有配置所用内衬重量，请联系管理员进行配置！",type:"error"}),0)},clickSearch:function(){this.pageConfig.current=1,this.getTableData({current:1})},reset:function(){this.searchForm={caster:"",furnace:"",date:[],ribbonTypeNames:[],ribbonWidths:[],ribbonThicknessLevels:[],laminationLevels:[],ribbonToughnessLevels:[],appearenceLevels:[]};this.pageConfig.current=1,this.getTableData({current:1})},getTableData:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={castId:this.castId,startTime:this.searchForm.date[0],endTime:this.searchForm.date[1],caster:this.searchForm.caster,furnace:this.searchForm.furnace,ribbonTypeNameJson:b()(this.searchForm.ribbonTypeNames),ribbonWidthJson:b()(this.searchForm.ribbonWidths),ribbonThicknessLevelJson:b()(this.searchForm.ribbonThicknessLevels),laminationLevelJson:b()(this.searchForm.laminationLevels),ribbonToughnessLevelJson:b()(this.searchForm.ribbonToughnessLevels),appearenceLevelJson:b()(this.searchForm.appearenceLevels),thicknessDivation:this.searchForm.thicknessDivation};l()(n,t),this.$http("get",L.a.queryMeasure,n).then(function(n){e.pageConfig.total=n.count,e.pageConfig.pageSize=n.limit,n.list&&n.list.forEach(function(n){5==e.userinfo.roleId?n.isEditing=!0:n.isEditing=!1,n.storageRule={orderThickness:n.orderThickness,orderLaminationFactor:n.orderLaminationFactor,orderRibbonToughnessLevels:n.orderRibbonToughnessLevels,orderAppearenceLevels:n.orderAppearenceLevels,qualifiedDemands:[1,2,3,5,6,15].includes(Number(e.userinfo.roleId))?JSON.parse(n.qualifiedDemands):[]},n.clients=n.clients?n.clients.split(","):[],n.appearence=n.appearence?n.appearence.split(","):[],n.coilNetWeight=n.coilWeight-e.calcLinerWeight(n.ribbonWidth),n.remainWeight=n.coilNetWeight}),e.tableData=n.list}).catch(function(e){console.log(e)}).finally(function(){e.loading=!1})},edit:function(e){if((1==e.isStored||2==e.isStored)&&1==e.isMeasureConfirmed)return this.$message({message:"该带材已经入库，您无权限操作，请联系库房主管人员！",type:"error"})},customerNumer:function(e){return"string"==typeof e?Number(e.trim()):e},calcRibbonTotalData:function(e){e.laminationFactor=this.calcLaminationFactor(e.coilWeight,e.diameter,e.realRibbonWidth),e.laminationLevel=this.calcLaminationLevel(e.laminationFactor),e.ribbonToughness=this.ribbonToughnessLevelList.reduce(function(e,n){return e[n.ribbonToughnessLevel]=n.ribbonToughness,e},{})[e.ribbonToughnessLevel]||"",e.ribbonThickness1=this.customerNumer(e.ribbonThickness1),e.ribbonThickness2=this.customerNumer(e.ribbonThickness2),e.ribbonThickness3=this.customerNumer(e.ribbonThickness3),e.ribbonThickness4=this.customerNumer(e.ribbonThickness4),e.ribbonThickness5=this.customerNumer(e.ribbonThickness5),e.ribbonThickness6=this.customerNumer(e.ribbonThickness6),e.ribbonThickness7=this.customerNumer(e.ribbonThickness7),e.ribbonThickness8=this.customerNumer(e.ribbonThickness8),e.ribbonThickness9=this.customerNumer(e.ribbonThickness9),e.ribbonThicknessDeviation=this.calcMaxDeviation([e.ribbonThickness1,e.ribbonThickness2,e.ribbonThickness3,e.ribbonThickness4,e.ribbonThickness5,e.ribbonThickness6,e.ribbonThickness7,e.ribbonThickness8,e.ribbonThickness9]),e.ribbonThickness=((e.ribbonThickness1+e.ribbonThickness2+e.ribbonThickness3+e.ribbonThickness4+e.ribbonThickness5+e.ribbonThickness6+e.ribbonThickness7+e.ribbonThickness8+e.ribbonThickness9)/9).toFixed(2),e.ribbonThicknessLevel=this.calcribbonThicknessLevel(e.ribbonThickness),e.ribbonTotalLevel=this.calcRibbonTotalLevel(e),"不合格"===e.ribbonTotalLevel?e.isStored=3:(e.isStored=this.setStoredType(e),1===e.isStored?(e.inPlanStoredWeight=e.coilNetWeight,2===e.ribbonThicknessLevel&&(e.inPlanThickRibbonWeight=e.coilNetWeight)):2===e.isStored&&(e.outPlanStoredWeight=e.coilNetWeight),e.totalStoredWeight=(e.inPlanStoredWeight+e.outPlanStoredWeight).toFixed(2),this.calcQualityOfABCDE(e),this.calcThinRibbonWeight(e),e.qualityOfGood=e.inPlanStoredWeight,2===e.isStored&&(/^[3-8][1-4][A-E][A-C]G?([+-]E)?F?$/.test(e.ribbonTotalLevel)||/^2[2-3][A-C]BL?([+-]E)?F?$/.test(e.ribbonTotalLevel)?e.qualityOfFine=e.coilNetWeight:e.qualityOfNormal=e.coilNetWeight));var n=Object(_.cloneDeep)(e);return n.clients=n.clients.join(),n.appearence=n.appearence.join(),s()(n).forEach(function(e){null==n[e]&&delete n[e]}),n},save:function(e){var n=this.calcRibbonTotalData(e);this.$http("PUT",L.a.updateMeasure,n).then(function(e){}).catch(function(e){console.log(e)})},handleCurrentChange:function(e){var n={current:e};this.getTableData(n)},calcRibbonTotalLevel:function(e){var n=["D","E"].includes(e.ribbonToughnessLevel);if("1K107B"==e.ribbonTypeName){if(e.ribbonThickness>34)return"不合格";if("8"==e.laminationLevel)return"不合格";if([32,42].includes(e.ribbonWidth)&&n)return"不合格"}if(e.ribbonThicknessDeviation>3&&e.ribbonWidth<50&&n)return"不合格";if(e.ribbonWidth<50&&n&&Math.abs(e.realRibbonWidth-e.ribbonWidth)>.2)return"不合格";if(e.ribbonWidth>=50&&n&&Math.abs(e.realRibbonWidth-e.ribbonWidth)>.3)return"不合格";if(["AD25","ND25"].includes(e.ribbonTypeName)){var t=e.realRibbonWidth-e.ribbonWidth;if((t=t.toFixed(1))>=.1||t<=-.2)return"不合格"}if(["AD25","ND25","1K107A","FN-300"].includes(e.ribbonTypeName)&&e.laminationFactor<.75)return"不合格";if(["FN-200","FN-035"].includes(e.ribbonTypeName)&&(e.ribbonThickness>23||e.laminationFactor<.78))return"不合格";if(["1K107O"].includes(e.ribbonTypeName)){if(e.ribbonThickness<22||e.ribbonThickness>28||e.laminationFactor<.78)return"不合格";if("C"===e.appearenceLevel||e.ribbonThicknessDeviation>=2)return"不合格"}if(["1K107BW","1K107E"].includes(e.ribbonTypeName)&&n)return"不合格";if(["",void 0,null].includes(e.ribbonThicknessLevel)||["",void 0,null].includes(e.laminationLevel)||["",void 0,null].includes(e.ribbonToughnessLevel)||["",void 0,null].includes(e.appearenceLevel))return"";var i=e.ribbonThicknessLevel+e.laminationLevel+e.ribbonToughnessLevel+e.appearenceLevel;e.ribbonThickness>24&&e.ribbonThickness<=25&&(i+="S"),e.ribbonThickness>23&&e.ribbonThickness<=24&&(i+="L"),e.ribbonThickness>21&&e.ribbonThickness<=22&&(i+="S"),e.ribbonThickness>20&&e.ribbonThickness<=21&&(i+="L"),e.ribbonThicknessDeviation>3&&["A","B","C"].includes(e.ribbonToughnessLevel)&&(i+="F");var r=e.realRibbonWidth-e.ribbonWidth;return r=r.toFixed(1),e.ribbonWidth<50?Math.abs(r)>.2&&["A","B","C"].includes(e.ribbonToughnessLevel)&&(r<-.2?i+="-E":r>.2&&(i+="+E")):e.ribbonWidth>=50&&Math.abs(r)>.3&&["A","B","C"].includes(e.ribbonToughnessLevel)&&(r<-.3?i+="-E":r>.3&&(i+="+E")),i},calcThinRibbonWeight:function(e){if(!(e.ribbonThickness>23))return e.laminationFactor>=.78?e.highFactorThinRibbonWeight=e.coilNetWeight:void(e.laminationFactor>=.75&&(e.thinRibbonWeight=e.coilNetWeight))},calcQualityOfABCDE:function(e){var n=e.ribbonTotalLevel;/^[3-8][2-4][A-E][A-C]G?([+-]E)?F?$/.test(n)?e.qualityOfA=e.coilNetWeight:/^[3-8]1[A-E][A-C]G?([+-]E)?F?$/.test(n)?e.qualityOfB=e.coilNetWeight:/^[3-8]0[A-E][A-C]G?([+-]E)?F?$/.test(n)?e.qualityOfC=e.coilNetWeight:/^2[1-4][A-E][A-C]L?([+-]E)?F?$/.test(n)?e.qualityOfD=e.coilNetWeight:/^1[1-4][A-E][A-C]([+-]E)?F?$/.test(n)&&(e.qualityOfE=e.coilNetWeight)},calcLaminationFactor:function(e,n,t){return((e-.09)/(Math.PI*(n*n/4-9025/4)*7.2)*Math.pow(10,6)/t).toFixed(2)||0},calcLaminationLevel:function(e){return e?e>=.84?"4":e>=.82&&e<.84?"3":e>=.8&&e<.82?"2":e>=.78&&e<.8?"1":e>=.75&&e<.78?"0":e>=.72&&e<.75?"8":"不合格":""},calcMaxDeviation:function(e){return e.sort(function(e,n){return e-n}),e[e.length-1]-e[0]},calcribbonThicknessLevel:function(e){if(e)return e>26?1:e>23&&e<=26?2:e>20&&e<=23?3:e>18&&e<=20?4:e>16&&e<=18?5:e>14&&e<=16?6:e>12&&e<=14?7:e<=12?8:void 0},setStoredType:function(e){var n=!0,t=e.ribbonThickness,i=e.orderThickness;if(i.indexOf("≤")>-1)t>parseInt(i.substr(1))&&(n=!1);else if(i.indexOf("-")>-1){var o=i.split("-")[1];(t<i.split("-")[0]||t>o)&&(n=!1)}var s=e.laminationFactor,a=e.orderLaminationFactor;if(a.indexOf("≥")>-1)s<parseInt(a.substr(1))&&(n=!1);else if(a.indexOf("-")>-1){var l=a.split("-")[1];(s<a.split("-")[0]||s>l)&&(n=!1)}var c=e.ribbonToughnessLevel;e.orderRibbonToughnessLevels.split(",").includes(c)||(n=!1);var b=e.appearenceLevel;if(e.orderAppearenceLevels.split(",").includes(b)||(n=!1),n)return 1;var u=JSON.parse(e.qualifiedDemands)||[],h=!0,p=!1,d=void 0;try{for(var v,f=r()(u);!(h=(v=f.next()).done);h=!0){var m=v.value,g=!0,T=m.qualifiedThickness;if(T.indexOf("≤")>-1)t>parseInt(T.substr(1))&&(g=!1);else if(T.indexOf("-")>-1){var k=T.split("-")[1];(t<T.split("-")[0]||t>k)&&(g=!1)}var _=m.qualifiedLaminationFactor;if(_.indexOf("≥")>-1)s<parseInt(_.substr(1))&&(g=!1);else if(_.indexOf("-")>-1){var L=_.split("-")[1];(s<_.split("-")[0]||s>L)&&(g=!1)}if(m.qualifiedRibbonToughnessLevels.includes(c)||(g=!1),m.qualifiedAppearenceLevels.includes(b)||(g=!1),g)return 2}}catch(e){p=!0,d=e}finally{try{!h&&f.return&&f.return()}finally{if(p)throw d}}return 3},exportExcel:function(){var e={castId:this.castId,startTime:this.searchForm.date[0],endTime:this.searchForm.date[1]};if(!e.startTime||!e.endTime)return this.$message({message:"请选择生产日期",type:"error"});var n=L.a.exportMeasure+"?"+k.a.stringify(e);window.open(n)},setSelectable:function(e,n){return!(![1,2].includes(e.isStored)||e.isMeasureConfirmed)},handleSelectionChange:function(e){this.multipleSelection=e},measureConfirm:function(){var e=this,n=Object(_.cloneDeep)(this.multipleSelection);return 0===n.length?this.$alert("请选择要入库的带材","提示",{type:"warning"}):n.some(function(e){return!e.clients||0===e.clients.length})?this.$alert("申请入库的带材没有填写检测去向，请检查后再提交","提示",{type:"warning"}):(n.forEach(function(e){e.isMeasureConfirmed=1,e.clients=e.clients.join(),e.appearence=e.appearence.join()}),void this.$http("POST",L.a.measureConfirm,{dataJson:b()(n)}).then(function(n){e.getTableData()}).catch(function(e){console.log(e)}))}})},F={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("el-breadcrumb",{staticClass:"crumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",[e._v("检测记录")]),e._v(" "),t("el-breadcrumb-item",[e._v(e._s(e.castId)+"号机组")])],1),e._v(" "),t("Collapse",[t("el-form",{staticClass:"search_bar",attrs:{model:e.searchForm,inline:!0}},[t("el-form-item",{attrs:{label:"生产日期："}},[t("el-date-picker",{attrs:{type:"daterange","default-time":["00:00:00","23:59:59"],clearable:!1,"start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.searchForm.date,callback:function(n){e.$set(e.searchForm,"date",n)},expression:"searchForm.date"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"喷带手："}},[t("el-input",{attrs:{placeholder:"请输入喷带手姓名"},model:{value:e.searchForm.caster,callback:function(n){e.$set(e.searchForm,"caster",n)},expression:"searchForm.caster"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"炉号："}},[t("el-input",{attrs:{placeholder:"请输入炉号"},model:{value:e.searchForm.furnace,callback:function(n){e.$set(e.searchForm,"furnace",n)},expression:"searchForm.furnace"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"材质："}},[t("el-select",{attrs:{placeholder:"请选择",multiple:"","collapse-tags":""},model:{value:e.searchForm.ribbonTypeNames,callback:function(n){e.$set(e.searchForm,"ribbonTypeNames",n)},expression:"searchForm.ribbonTypeNames"}},e._l(e.ribbonTypeList,function(e){return t("el-option",{key:e.ribbonTypeId,attrs:{value:e.ribbonTypeName,label:e.ribbonTypeName}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"规格："}},[t("el-select",{attrs:{placeholder:"请选择",multiple:"","collapse-tags":""},model:{value:e.searchForm.ribbonWidths,callback:function(n){e.$set(e.searchForm,"ribbonWidths",n)},expression:"searchForm.ribbonWidths"}},e._l(e.ribbonWidthList,function(e){return t("el-option",{key:e.ribbonWidthId,attrs:{label:e.ribbonWidth,value:e.ribbonWidth}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"厚度级别："}},[t("el-select",{attrs:{placeholder:"请选择",multiple:"","collapse-tags":""},model:{value:e.searchForm.ribbonThicknessLevels,callback:function(n){e.$set(e.searchForm,"ribbonThicknessLevels",n)},expression:"searchForm.ribbonThicknessLevels"}},e._l(e.ribbonThicknessLevelList,function(e){return t("el-option",{key:e.ribbonThicknessLevelId,attrs:{label:e.ribbonThicknessLevel,value:e.ribbonThicknessLevel}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"叠片级别："}},[t("el-select",{attrs:{placeholder:"请选择",multiple:"","collapse-tags":""},model:{value:e.searchForm.laminationLevels,callback:function(n){e.$set(e.searchForm,"laminationLevels",n)},expression:"searchForm.laminationLevels"}},e._l(e.laminationLevelList,function(e){return t("el-option",{key:e.laminationLevelId,attrs:{label:e.laminationLevel,value:e.laminationLevel}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"韧性级别："}},[t("el-select",{attrs:{placeholder:"请选择",multiple:"","collapse-tags":""},model:{value:e.searchForm.ribbonToughnessLevels,callback:function(n){e.$set(e.searchForm,"ribbonToughnessLevels",n)},expression:"searchForm.ribbonToughnessLevels"}},e._l(e.ribbonToughnessLevelList,function(e){return t("el-option",{key:e.ribbonToughnessLevelId,attrs:{label:e.ribbonToughnessLevel,value:e.ribbonToughnessLevel}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"外观级别："}},[t("el-select",{attrs:{placeholder:"请选择",multiple:"","collapse-tags":""},model:{value:e.searchForm.appearenceLevels,callback:function(n){e.$set(e.searchForm,"appearenceLevels",n)},expression:"searchForm.appearenceLevels"}},e._l(e.uniqueAppearenceLevelList,function(e,n){return t("el-option",{key:n,attrs:{label:e,value:e}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"厚度偏差："}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.searchForm.thicknessDivation,callback:function(n){e.$set(e.searchForm,"thicknessDivation",n)},expression:"searchForm.thicknessDivation"}},[t("el-option",{attrs:{label:"<=1",value:1}}),e._v(" "),t("el-option",{attrs:{label:"<=2",value:2}}),e._v(" "),t("el-option",{attrs:{label:"<=3",value:3}}),e._v(" "),t("el-option",{attrs:{label:"<=4",value:4}}),e._v(" "),t("el-option",{attrs:{label:"<=5",value:5}})],1)],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.clickSearch}},[e._v("搜索")]),e._v(" "),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),e._v(" "),t("div",{staticClass:"main_bd"},[t("el-col",{staticClass:"table_hd"},[[1,2,3,5].includes(e.userinfo.roleId)?t("el-button",{attrs:{type:e.autoQueryConfig.type,icon:e.autoQueryConfig.icon},on:{click:e.handleAutoQuery}},[e._v(e._s(e.autoQueryConfig.text))]):e._e(),e._v(" "),t("el-tooltip",{attrs:{content:"点击后会计算下表中带材的综合级别",placement:"top-end"}},[[1,2,3,5].includes(e.userinfo.roleId)?t("el-button",{attrs:{type:"primary",icon:"el-icon-info"},on:{click:e.batchCalcRibbonTotalData}},[e._v("计算综合级别")]):e._e()],1),e._v(" "),[1,2,3,5].includes(e.userinfo.roleId)?t("el-button",{staticClass:"pull_right",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-download"},on:{click:e.exportExcel}},[e._v("导出")]):e._e(),e._v(" "),[1,2,3,5].includes(e.userinfo.roleId)?t("el-button",{staticClass:"pull_right",attrs:{type:"primary",icon:"el-icon-check"},on:{click:e.measureConfirm}},[e._v("申请入库")]):e._e()],1),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:"","highlight-current-row":"",height:e.tableHeight},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"20",selectable:e.setSelectable}}),e._v(" "),t("el-table-column",{attrs:{prop:"furnace",label:"炉号",align:"center",width:"130px",fixed:""}}),e._v(" "),t("el-table-column",{attrs:{prop:"coilNumber",label:"盘号",align:"center",width:"35px",fixed:""}}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonTypeName",label:"材质",align:"center","min-width":"50px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonWidth",label:"规格",align:"center",width:"40px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"castDate",label:"生产日期",align:"center",formatter:e.dateFormat,width:"80px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"caster",label:"喷带手",align:"center",width:"50px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"diameter",label:"外径(mm)",align:"center",width:"70px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"coilWeight",label:"重量(kg)",align:"center",width:"70px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"laminationFactor",label:"叠片系数",align:"center",width:"70px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"laminationLevel",label:"叠片等级",align:"center",width:"70px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"realRibbonWidth",label:"实际带宽",align:"center",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.realRibbonWidth)+"\n          ")]):t("div",[t("el-input",{attrs:{size:"mini"},model:{value:n.row.realRibbonWidth,callback:function(t){e.$set(n.row,"realRibbonWidth",t)},expression:"scope.row.realRibbonWidth"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonThickness1",label:"带厚1(μm)",align:"center",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.ribbonThickness1)+"\n          ")]):t("div",[t("el-input",{attrs:{size:"mini"},nativeOn:{keyup:function(t){return function(t){return e.thicknessChangeHandler(t,n.row)}(t)}},model:{value:n.row.ribbonThickness1,callback:function(t){e.$set(n.row,"ribbonThickness1",t)},expression:"scope.row.ribbonThickness1"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonThickness2",label:"带厚2(μm)",align:"center",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.ribbonThickness2)+"\n          ")]):t("div",[t("el-input",{attrs:{size:"mini"},nativeOn:{keyup:function(t){return function(t){return e.thicknessChangeHandler(t,n.row)}(t)}},model:{value:n.row.ribbonThickness2,callback:function(t){e.$set(n.row,"ribbonThickness2",t)},expression:"scope.row.ribbonThickness2"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonThickness3",label:"带厚3(μm)",align:"center",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.ribbonThickness3)+"\n          ")]):t("div",[t("el-input",{attrs:{size:"mini"},nativeOn:{keyup:function(t){return function(t){return e.thicknessChangeHandler(t,n.row)}(t)}},model:{value:n.row.ribbonThickness3,callback:function(t){e.$set(n.row,"ribbonThickness3",t)},expression:"scope.row.ribbonThickness3"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonThickness4",label:"带厚4(μm)",align:"center",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.ribbonThickness4)+"\n          ")]):t("div",[t("el-input",{attrs:{size:"mini"},nativeOn:{keyup:function(t){return function(t){return e.thicknessChangeHandler(t,n.row)}(t)}},model:{value:n.row.ribbonThickness4,callback:function(t){e.$set(n.row,"ribbonThickness4",t)},expression:"scope.row.ribbonThickness4"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonThickness5",label:"带厚5(μm)",align:"center",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.ribbonThickness5)+"\n          ")]):t("div",[t("el-input",{attrs:{size:"mini"},nativeOn:{keyup:function(t){return function(t){return e.thicknessChangeHandler(t,n.row)}(t)}},model:{value:n.row.ribbonThickness5,callback:function(t){e.$set(n.row,"ribbonThickness5",t)},expression:"scope.row.ribbonThickness5"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonThickness6",label:"带厚6(μm)",align:"center",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.ribbonThickness6)+"\n          ")]):t("div",[t("el-input",{attrs:{size:"mini"},nativeOn:{keyup:function(t){return function(t){return e.thicknessChangeHandler(t,n.row)}(t)}},model:{value:n.row.ribbonThickness6,callback:function(t){e.$set(n.row,"ribbonThickness6",t)},expression:"scope.row.ribbonThickness6"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonThickness7",label:"带厚7(μm)",align:"center",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.ribbonThickness7)+"\n          ")]):t("div",[t("el-input",{attrs:{size:"mini"},nativeOn:{keyup:function(t){return function(t){return e.thicknessChangeHandler(t,n.row)}(t)}},model:{value:n.row.ribbonThickness7,callback:function(t){e.$set(n.row,"ribbonThickness7",t)},expression:"scope.row.ribbonThickness7"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonThickness8",label:"带厚8(μm)",align:"center",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.ribbonThickness8)+"\n          ")]):t("div",[t("el-input",{attrs:{size:"mini"},nativeOn:{keyup:function(t){return function(t){return e.thicknessChangeHandler(t,n.row)}(t)}},model:{value:n.row.ribbonThickness8,callback:function(t){e.$set(n.row,"ribbonThickness8",t)},expression:"scope.row.ribbonThickness8"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonThickness9",label:"带厚9(μm)",align:"center",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.ribbonThickness9)+"\n          ")]):t("div",[t("el-input",{attrs:{size:"mini"},nativeOn:{keyup:function(t){return function(t){return e.thicknessChangeHandler(t,n.row)}(t)}},model:{value:n.row.ribbonThickness9,callback:function(t){e.$set(n.row,"ribbonThickness9",t)},expression:"scope.row.ribbonThickness9"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonThicknessDeviation",label:"厚度偏差(μm)",align:"center",width:"90px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonThickness",label:"平均厚度(μm)",align:"center",width:"90px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonThicknessLevel",label:"厚度级别",align:"center",width:"70px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonToughness",label:"韧性",align:"center",width:"70px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonToughnessLevel",label:"韧性等级",align:"center",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.ribbonToughnessLevel)+"\n          ")]):t("div",[t("el-select",{attrs:{size:"mini",placeholder:""},model:{value:n.row.ribbonToughnessLevel,callback:function(t){e.$set(n.row,"ribbonToughnessLevel",t)},expression:"scope.row.ribbonToughnessLevel"}},e._l(e.ribbonToughnessLevelList,function(e){return t("el-option",{key:e.ribbonToughnessLevelId,attrs:{label:e.ribbonToughnessLevel,value:e.ribbonToughnessLevel}})}),1)],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"appearence",label:"外观",align:"center",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.appearence?n.row.appearence.toString():"")+"\n          ")]):t("div",[t("el-select",{attrs:{size:"mini",multiple:"","collapse-tags":"",placeholder:""},model:{value:n.row.appearence,callback:function(t){e.$set(n.row,"appearence",t)},expression:"scope.row.appearence"}},e._l(e.appearenceList,function(e){return t("el-option",{key:e.appearenceLevelId,attrs:{label:e.appearence,value:e.appearence}})}),1)],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"appearenceLevel",label:"外观等级",align:"center",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.appearenceLevel)+"\n          ")]):t("div",[t("el-select",{attrs:{size:"mini",placeholder:""},model:{value:n.row.appearenceLevel,callback:function(t){e.$set(n.row,"appearenceLevel",t)},expression:"scope.row.appearenceLevel"}},e._l(e.uniqueAppearenceLevelList,function(e,n){return t("el-option",{key:n,attrs:{label:e,value:e}})}),1)],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"ribbonTotalLevel",label:"综合级别",align:"center",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("span",{class:"不合格"===n.row.ribbonTotalLevel?"text_danger":""},[e._v(e._s(n.row.ribbonTotalLevel))])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"入库规则",align:"center",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-popover",{attrs:{placement:"right",trigger:"hover"}},[t("table",{staticClass:"popover_table",attrs:{cellpadding:"0",cellspacing:"0"}},[t("thead",[t("th",[e._v("类别")]),e._v(" "),t("th",[e._v("带厚")]),e._v(" "),t("th",[e._v("叠片")]),e._v(" "),t("th",[e._v("韧性")]),e._v(" "),t("th",[e._v("外观")])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("计划内入库要求")]),e._v(" "),t("td",[e._v(e._s(n.row.storageRule.orderThickness))]),e._v(" "),t("td",[e._v(e._s(n.row.storageRule.orderLaminationFactor))]),e._v(" "),t("td",[e._v("\n                    "+e._s(n.row.storageRule.orderRibbonToughnessLevels)+"\n                  ")]),e._v(" "),t("td",[e._v(e._s(n.row.storageRule.orderAppearenceLevels))])]),e._v(" "),e._l(n.row.storageRule.qualifiedDemands,function(n,i){return t("tr",{key:i},[t("td",[e._v("计划外入库要求")]),e._v(" "),t("td",[e._v(e._s(n.qualifiedThickness))]),e._v(" "),t("td",[e._v(e._s(n.qualifiedLaminationFactor))]),e._v(" "),t("td",[e._v(e._s(n.qualifiedRibbonToughnessLevels.join()))]),e._v(" "),t("td",[e._v(e._s(n.qualifiedAppearenceLevels.join()))])])})],2)]),e._v(" "),t("el-button",{attrs:{slot:"reference",size:"mini",type:"text"},slot:"reference"},[e._v("详情")])],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"isStorageConfirmed",label:"是否入库",align:"center",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("div",[1===n.row.isStorageConfirmed?t("span",[e._v("是")]):t("span",{staticClass:"text_danger"},[e._v("否")])])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"isStored",label:"入库类别",align:"center",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isStorageConfirmed?t("div",[1===n.row.isStored?t("span",[e._v("计划内")]):e._e(),e._v(" "),2===n.row.isStored?t("span",[e._v("计划外")]):e._e(),e._v(" "),3===n.row.isStored?t("span",{staticClass:"text_danger"},[e._v("否")]):e._e()]):e._e()]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"unStoreReason",label:"不入库原因",align:"center","min-width":"70px","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",{staticClass:"text_danger"},[e._v("\n            "+e._s(n.row.unStoreReason)+"\n          ")]):t("div",[t("el-input",{attrs:{size:"mini"},model:{value:n.row.unStoreReason,callback:function(t){e.$set(n.row,"unStoreReason",t)},expression:"scope.row.unStoreReason"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"clients",label:"判定去向",align:"center",width:"80px","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.isMeasureConfirmed||5!=e.userinfo.roleId?t("div",[e._v("\n            "+e._s(n.row.clients?n.row.clients.toString():"")+"\n          ")]):t("div",[t("el-select",{attrs:{size:"mini",placeholder:"",multiple:"","collapse-tags":""},model:{value:n.row.clients,callback:function(t){e.$set(n.row,"clients",t)},expression:"scope.row.clients"}},e._l(e.clientsList,function(e){return t("el-option",{key:e.clientsId,attrs:{label:e.client,value:e.client,disabled:0===e.isFlat&&1===n.row.isFlat}})}),1)],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"measureDate",label:"检测时间",align:"center",width:"100px",formatter:e.dateTimeFormat,"show-overflow-tooltip":!0}}),e._v(" "),5==e.userinfo.roleId||1==e.userinfo.roleId?t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[1!==n.row.isMeasureConfirmed?t("el-button",{attrs:{size:"mini",type:"success",disabled:!e.isEditable},on:{click:function(t){return e.save(n.row)}}},[e._v("保存")]):e._e()]}}],null,!1,2588052046)}):e._e()],1),e._v(" "),t("el-pagination",{attrs:{background:"",layout:"total,prev,pager,next",total:e.pageConfig.total,"current-page":e.pageConfig.current,"page-size":e.pageConfig.pageSize},on:{"update:currentPage":function(n){return e.$set(e.pageConfig,"current",n)},"update:current-page":function(n){return e.$set(e.pageConfig,"current",n)},"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var C=t("VU/8")(x,F,!1,function(e){t("5qv0")},"data-v-2ff79073",null);n.default=C.exports},BO1k:function(e,n,t){e.exports={default:t("fxRn"),__esModule:!0}},Cdx3:function(e,n,t){var i=t("sB3e"),r=t("lktj");t("uqUo")("keys",function(){return function(e){return r(i(e))}})},fZjL:function(e,n,t){e.exports={default:t("jFbC"),__esModule:!0}},fxRn:function(e,n,t){t("+tPU"),t("zQR9"),e.exports=t("g8Ux")},g8Ux:function(e,n,t){var i=t("77Pl"),r=t("3fs2");e.exports=t("FeBl").getIterator=function(e){var n=r(e);if("function"!=typeof n)throw TypeError(e+" is not iterable!");return i(n.call(e))}},jFbC:function(e,n,t){t("Cdx3"),e.exports=t("FeBl").Object.keys},uqUo:function(e,n,t){var i=t("kM2E"),r=t("FeBl"),o=t("S82l");e.exports=function(e,n){var t=(r.Object||{})[e]||Object[e],s={};s[e]=n(t),i(i.S+i.F*o(function(){t(1)}),"Object",s)}}});
//# sourceMappingURL=measure.2499460def3b57220bcb.js.map