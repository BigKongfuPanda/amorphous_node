webpackJsonp([18],{"R/iZ":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("woOf"),l=a.n(n),o=a("mvHQ"),i=a.n(o),r=(a("mw3O"),a("M4fF")),c=a("g7mi"),s=a("X2Oc"),u={name:"storage",components:{Collapse:a("IC2r").a},data:function(){return{roleId:0,searchForm:{castIds:[6],furnaces:[]},pageConfig:{total:1,current:1,pageSize:10},loading:!1,selectLoading:!1,furnaceList:[],totalCoilNum:null,totalWeight:null,tableData:[],tableHeight:200,multipleSelection:[]}},created:function(){var e=JSON.parse(localStorage.getItem("userinfo"));this.roleId=e&&e.roleId||0,this.getTableData()},mounted:function(){var e=this;e.$nextTick(function(){e.tableHeight=window.innerHeight-100}),window.onresize=Object(s.c)(function(){e.tableHeight=window.innerHeight-100},1e3)},methods:{dateTimeFormat:function(e,t){return e.measureConfirmDate?Object(s.b)(e.measureConfirmDate):""},clickSearch:function(){this.pageConfig.current=1,this.getTableData({current:1})},reset:function(){this.searchForm={castIds:[],furnaces:[]};this.pageConfig.current=1,this.getTableData({current:1})},getTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a={castIds:i()(this.searchForm.castIds),furnaceJson:i()(this.searchForm.furnaces)};l()(t,a),this.loading=!0,this.$http("get",c.a.queryApplyStorage,t).then(function(t){e.tableData=t.list,e.pageConfig.total=t.count,e.pageConfig.pageSize=t.limit}).catch(function(e){console.log(e)}).finally(function(){e.loading=!1})},edit:function(e){e.isEditing=!0},del:function(e){var t=this,a=e.measureId,n=e.furnace,l=e.coilNumber;this.$confirm("确定驳回 "+n+" 的第 "+l+" 盘吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http("post",c.a.rejectApplyStorage,{measureId:a}).then(function(e){t.getTableData()}).catch(function(e){console.log(e)})}).catch(function(){})},save:function(e){e.isEditing=!1,e.takeBy?e.remainWeight=0:e.remainWeight=e.coilNetWeight,this.$http("PUT",c.a.updateStorage,e).then(function(e){}).catch(function(e){console.log(e)})},setSelectable:function(e,t){return!0},handleSelectionChange:function(e){this.multipleSelection=e,this.totalCoilNum=this.multipleSelection.length,this.totalWeight=this.multipleSelection.reduce(function(e,t){return e+t.coilNetWeight},0)},remoteMethod:function(e){var t=this;""!==e?(this.selectLoading=!0,this.$http("GET",c.a.queryFurnaceList,{query:e}).then(function(e){t.furnaceList=e.list}).catch(function(e){console.log(e)}).finally(function(){t.selectLoading=!1})):this.furnaceList=[]},confirmInStore:function(){var e=this,t=Object(r.cloneDeep)(this.multipleSelection);if(0===t.length)return this.$alert("请选择要入库的带材","提示",{type:"warning"});this.$http("POST",c.a.batchAddStorage,{dataJson:i()(t)}).then(function(t){e.getTableData()}).catch(function(e){console.log(e)})},handleCurrentChange:function(e){var t={current:e};this.getTableData(t)}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{staticClass:"crumb",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[e._v("库存记录")]),e._v(" "),a("el-breadcrumb-item",[e._v("申请入库")])],1),e._v(" "),a("Collapse",[a("el-form",{staticClass:"search_bar",attrs:{model:e.searchForm,inline:!0}},[a("el-form-item",{attrs:{label:"炉号："}},[a("el-select",{attrs:{placeholder:"请输入炉号关键字",multiple:"",filterable:"",remote:"","collapse-tags":"",loading:e.selectLoading,"remote-method":e.remoteMethod},model:{value:e.searchForm.furnaces,callback:function(t){e.$set(e.searchForm,"furnaces",t)},expression:"searchForm.furnaces"}},e._l(e.furnaceList,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"机组："}},[a("el-select",{attrs:{placeholder:"请选择",multiple:""},model:{value:e.searchForm.castIds,callback:function(t){e.$set(e.searchForm,"castIds",t)},expression:"searchForm.castIds"}},[a("el-option",{attrs:{value:6,label:"6"}}),e._v(" "),a("el-option",{attrs:{value:7,label:"7"}}),e._v(" "),a("el-option",{attrs:{value:8,label:"8"}}),e._v(" "),a("el-option",{attrs:{value:9,label:"9"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.clickSearch}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),e._v(" "),a("el-row",{staticClass:"total_data"},[a("el-col",{attrs:{span:4}},[e._v("总盘数："+e._s(e.totalCoilNum))]),e._v(" "),a("el-col",{attrs:{span:4}},[e._v("总重量(kg)："+e._s(e.totalWeight))])],1),e._v(" "),a("div",{staticClass:"main_bd"},[a("el-col",{staticClass:"table_hd"},[6===e.roleId?a("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:e.confirmInStore}},[e._v("确认入库")]):e._e()],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:"",height:e.tableHeight},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center","class-name":"selection",selectable:e.setSelectable}}),e._v(" "),a("el-table-column",{attrs:{prop:"furnace",label:"炉号",align:"center",width:"130px",fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"coilNumber",label:"盘号",align:"center",width:"50px",fixed:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"ribbonTypeName",label:"材质",align:"center",width:"70px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ribbonWidth",label:"规格",align:"center",width:"50px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ribbonTotalLevel",label:"综合级别",align:"center",width:"90px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"coilWeight",label:"毛重",align:"center",width:"70px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"clients",label:"检测判定去向",align:"center",width:"100px","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.clients))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"isStored",label:"预计入库类型",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.isStored?a("span",[e._v("计划内入库")]):e._e(),e._v(" "),2==t.row.isStored?a("span",[e._v("计划外入库")]):e._e(),e._v(" "),3==t.row.isStored?a("span",[e._v("否")]):e._e(),e._v(" "),4==t.row.isStored?a("span",{staticClass:"text_warn"},[e._v("退货入库")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"measureConfirmDate",label:"申请入库时间",align:"center",width:"90px",formatter:e.dateTimeFormat,"show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(t){return[[1,6].includes(e.roleId)?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.del(t.row)}}},[e._v("驳回")]):e._e()]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"",layout:"total,prev,pager,next",total:e.pageConfig.total,"current-page":e.pageConfig.current,"page-size":e.pageConfig.pageSize},on:{"update:currentPage":function(t){return e.$set(e.pageConfig,"current",t)},"update:current-page":function(t){return e.$set(e.pageConfig,"current",t)},"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var p=a("VU/8")(u,h,!1,function(e){a("Uokc")},"data-v-7b7721e6",null);t.default=p.exports},Uokc:function(e,t){}});
//# sourceMappingURL=ApplyStore.72d9d11de05f03dd1cb5.js.map